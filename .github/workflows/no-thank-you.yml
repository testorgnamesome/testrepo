# github.event.issue_comment.author_association != "MEMBER" &&
#
#      (contains(github.event.issue.labels.*.name, '<contributions-welcome>') ||
#      contains(github.event.issue.labels.*.name, '<good first issue>'))

#      ${{ !github.event.issue.pull_request }} && 
#  && ${{ !contains(github.event.issue.labels.*.name, 'good first issue') }}
# ${{ !contains(github.event.issue.labels.*.name, 'contributions-welcome') }}


name: Comment No Thank You
on:
  issue_comment:
    types:
      - created

jobs:
  check-user-team:
    name: Team affiliation
    runs-on: ubuntu-latest
    steps:
      - name: Check user for team affiliation
        uses: tspascoal/get-user-teams-membership@v2
        id: teamAffiliation
        with:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          username: ${{ github.event.comment.user.login }}
          team: core-team
      - name: Stop workflow if user is no member
        if: ${{ steps.teamAffiliation.outputs.isTeamMember == 'false' }}
        run: |
          echo "No response for core team members."
          exit 1
  add-comment:
    runs-on: ubuntu-latest
    if: ${{ !contains(github.event.issue.labels.*.name, 'contributions-welcome') && 
        !contains(github.event.issue.labels.*.name, 'good first issue') && 
        !github.event.issue.pull_request }} # && 
#        github.event.comment.author_association != 'MEMBER' }}
    permissions:
      issues: write
    steps:
      - name: Add comment
        run: |
          gh issue comment "$NUMBER" --body  "@${{ github.event.comment.user.login }} $BODY"
#          echo "User Association: ${{ github.event.comment.author_association }}"
#          echo "@$USERNAME"
#          echo "@$USER_NAME"
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          GH_REPO: ${{ github.repository }}
          NUMBER: ${{ github.event.issue.number }}
          USER_NAME: ${{ github.event.comment.user.name }}
          USERNAME: ${{ github.event.comment.username }}
          BODY: >
            Thank you for reaching out! Unfortunately, this issue is not suitable for open source 
            contribution and so hasn't been marked with "good first issue" or "contributions welcome".
            Please consult our [contribution guidelines](https://github.com/openclimatefix#how-to-get-involved) for more information on how you can contribute, 
            and hope to see you around!
